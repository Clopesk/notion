<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">  
<title>Temporizador Digital</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: var(--bg-color, rgb(25, 25, 25));
    color: var(--text-color, white);
    text-align: center;
    padding-top: 50px;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  
  #timer {
    font-size: 48px;
    color: var(--timer-color, white);
    transition: color 0.3s ease;
  }
  
 .button-container {
    margin-bottom: 20px;
  }
  
  .icon-button {
    font-size: 24px;
    margin: 10px;
    padding: 15px;
    cursor: pointer;
    background-color: transparent;
    color: var(--button-color, white);
    border: none;
    outline: none;
    opacity: 1;
    transition: opacity 0.3s ease, color 0.3s ease;
  }
  
  .icon-button:hover {
    color: var(--button-hover-color, #555);
  }
  
  .icon-button:disabled {
    opacity: 0.5;
    color: #888;
    cursor: not-allowed;
  }

  /* Modal de Configura√ß√µes */
  .modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
  }

  .modal-content {
    background-color: #1a1a1a;
    margin: 10% auto;
    padding: 20px;
    border: 1px solid #333;
    border-radius: 10px;
    width: 320px;
    max-width: 95%;
    color: white;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
  }

  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 1px solid #333;
  }

  .modal-title {
    font-size: 1.2rem;
    font-weight: bold;
    color: #ffffff;
  }

  .close {
    color: #aaa;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    transition: color 0.3s ease;
  }

  .close:hover {
    color: #ffffff;
  }

  .config-section {
    margin-bottom: 15px;
  }

  .config-section h3 {
    margin-bottom: 10px;
    color: #cccccc;
    font-size: 1rem;
  }

  .time-inputs {
    display: flex;
    justify-content: space-between;
    gap: 10px;
    margin-bottom: 15px;
  }

  .time-input-group {
    flex: 1;
    text-align: left;
  }

  .time-input-group label {
    display: block;
    margin-bottom: 5px;
    font-size: 0.8rem;
    color: #bbbbbb;
  }

  .time-input-group input {
    width: 100%;
    padding: 8px;
    border: 1px solid #444;
    border-radius: 6px;
    background-color: #2a2a2a;
    color: white;
    font-size: 0.9rem;
    text-align: center;
  }

  .time-input-group input:focus {
    outline: none;
    border-color: #007AFF;
    box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
  }

  .color-section {
    margin-bottom: 20px;
  }

  .color-inputs {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
  }

  .color-input-group {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .color-input-group label {
    font-size: 0.9rem;
    color: #bbbbbb;
    min-width: 80px;
  }

  .color-input-group input[type="color"] {
    width: 50px;
    height: 35px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    background: none;
  }

  .color-input-group input[type="color"]::-webkit-color-swatch-wrapper {
    padding: 0;
  }

  .color-input-group input[type="color"]::-webkit-color-swatch {
    border: 2px solid #444;
    border-radius: 8px;
  }

  .button-group {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
    margin-top: 15px;
  }

  .btn {
    padding: 8px 16px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.8rem;
    font-weight: 500;
    transition: all 0.3s ease;
  }

  .btn-primary {
    background: linear-gradient(135deg, #007AFF 0%, #0051D5 100%);
    color: white;
  }

  .btn-primary:hover {
    background: linear-gradient(135deg, #0051D5 0%, #0040AA 100%);
    transform: translateY(-1px);
  }

  .btn-secondary {
    background: #333333;
    color: white;
  }

  .btn-secondary:hover {
    background: #444444;
  }

  .preset-colors {
    display: flex;
    gap: 8px;
    margin-top: 8px;
  }

  .preset-color {
    width: 25px;
    height: 25px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.3s ease;
  }

  .preset-color:hover {
    transform: scale(1.1);
    border-color: #ffffff;
  }

  .preset-color.active {
    border-color: #007AFF;
    transform: scale(1.1);
  }
</style>
</head>
<body>
<div class="button-container">
  <button class="icon-button" onclick="setTime(pomodoroTime)" id="pomodoroBtn">
    <i class="fas fa-hourglass-start"></i>
  </button>
  <button class="icon-button" onclick="setTime(shortBreakTime)" id="shortBreakBtn">
    <i class="fas fa-mug-hot"></i>
  </button>
  <button class="icon-button" onclick="setTime(longBreakTime)" id="longBreakBtn">
    <i class="fas fa-bed"></i>
  </button>
</div>
  
<div id="timer">25:00</div>
 <br> 
<button class="icon-button" id="startPauseBtn" onclick="startPauseTimer()">
  <i class="fas fa-play"></i>
</button>
<button class="icon-button" id="resetBtn" onclick="resetTimer()" disabled>
  <i class="fas fa-redo-alt"></i>
</button>
<button class="icon-button" id="configureBtn" onclick="openModal()">
  <i class="fas fa-cog"></i>
</button>

<!-- Modal de Configura√ß√µes -->
<div id="configModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">Configura√ß√µes</h2>
      <span class="close" onclick="closeModal()">&times;</span>
    </div>
    
    <div class="config-section">
      <h3>‚è±Ô∏è Tempos (minutos)</h3>
      <div class="time-inputs">
        <div class="time-input-group">
          <label for="pomodoroTime">Pomodoro</label>
          <input type="number" id="pomodoroTime" min="1" max="60" value="25">
        </div>
        <div class="time-input-group">
          <label for="shortBreakTime">Pausa Curta</label>
          <input type="number" id="shortBreakTime" min="1" max="30" value="5">
        </div>
        <div class="time-input-group">
          <label for="longBreakTime">Pausa Longa</label>
          <input type="number" id="longBreakTime" min="1" max="60" value="10">
        </div>
      </div>
    </div>

    <div class="config-section">
      <h3>üé® Cores</h3>
      <div class="color-inputs">
        <div class="color-input-group">
          <label>Fundo</label>
          <input type="color" id="bgColor" value="#000000">
        </div>
        <div class="color-input-group">
          <label>Texto</label>
          <input type="color" id="textColor" value="#ffffff">
        </div>
        <div class="color-input-group">
          <label>Bot√µes</label>
          <input type="color" id="buttonColor" value="#ffffff">
        </div>
        <div class="color-input-group">
          <label>Timer</label>
          <input type="color" id="timerColor" value="#ffffff">
        </div>
      </div>
      
      <div class="preset-colors">
        <div class="preset-color active" style="background: linear-gradient(135deg, #191919, #333333)" onclick="applyPreset('dark')"></div>
        <div class="preset-color" style="background: linear-gradient(135deg, #ffffff, #cccccc)" onclick="applyPreset('light')"></div>
        <div class="preset-color" style="background: linear-gradient(135deg, #1a1a2e, #16213e)" onclick="applyPreset('navy')"></div>
        <div class="preset-color" style="background: linear-gradient(135deg, #0f3460, #533483)" onclick="applyPreset('purple')"></div>
      </div>
    </div>

    <div class="button-group">
      <button class="btn btn-secondary" onclick="resetSettings()">Reset</button>
      <button class="btn btn-primary" onclick="saveSettings()">Guardar</button>
    </div>
  </div>
</div>

<audio id="beepSound" src="birds.mp3"></audio>

<script>
  let timerInterval;
  let timeLeft = 1500;
  let running = false;
  let selectedOption = 25;
  
  // Fun√ß√µes auxiliares para ambiente Notion
  function isNotionEnvironment() {
    return window.self !== window.top || navigator.userAgent.includes('Notion') || window.location.href.includes('notion');
  }
  
  function safeLocalStorage(action, key, value) {
    try {
      if (typeof localStorage !== 'undefined' && localStorage) {
        if (action === 'get') {
          return localStorage.getItem(key);
        } else if (action === 'set') {
          localStorage.setItem(key, value);
          return true;
        } else if (action === 'remove') {
          localStorage.removeItem(key);
          return true;
        }
      }
    } catch (e) {
      console.log('localStorage n√£o dispon√≠vel:', e);
      return action === 'get' ? null : false;
    }
    return action === 'get' ? null : false;
  }
  
  // Configura√ß√µes padr√£o
  let pomodoroTime = 25;
  let shortBreakTime = 5;
  let longBreakTime = 10;
  
  // Cores padr√£o
  let bgColor = '#191919'; // Notion dark mode RGB(25,25,25)
  let textColor = '#ffffff';
  let buttonColor = '#ffffff';
  let timerColor = '#ffffff';
  let buttonHoverColor = '#555555';
  
  // Carregar configura√ß√µes salvas
  function loadSettings() {
    const saved = safeLocalStorage('get', 'pomodoroSettings');
    if (saved) {
      try {
        const settings = JSON.parse(saved);
        pomodoroTime = settings.pomodoroTime || 25;
        shortBreakTime = settings.shortBreakTime || 5;
        longBreakTime = settings.longBreakTime || 10;
        bgColor = settings.bgColor || '#000000';
        textColor = settings.textColor || '#ffffff';
        buttonColor = settings.buttonColor || '#ffffff';
        timerColor = settings.timerColor || '#ffffff';
        buttonHoverColor = settings.buttonHoverColor || '#555555';
      } catch (e) {
        console.log('Erro ao carregar configura√ß√µes:', e);
      }
      
      // Aplicar cores
      applyColors();
      
      // Atualizar inputs
      document.getElementById('pomodoroTime').value = pomodoroTime;
      document.getElementById('shortBreakTime').value = shortBreakTime;
      document.getElementById('longBreakTime').value = longBreakTime;
      document.getElementById('bgColor').value = bgColor;
      document.getElementById('textColor').value = textColor;
      document.getElementById('buttonColor').value = buttonColor;
      document.getElementById('timerColor').value = timerColor;
    }
  }
  
  // Aplicar cores ao CSS
  function applyColors() {
    document.documentElement.style.setProperty('--bg-color', bgColor);
    document.documentElement.style.setProperty('--text-color', textColor);
    document.documentElement.style.setProperty('--button-color', buttonColor);
    document.documentElement.style.setProperty('--timer-color', timerColor);
    document.documentElement.style.setProperty('--button-hover-color', buttonHoverColor);
  }
  
  // Presets de cores
  function applyPreset(preset) {
    const presets = {
      dark: {
        bgColor: '#191919', // Notion dark mode RGB(25,25,25)
        textColor: '#ffffff',
        buttonColor: '#ffffff',
        timerColor: '#ffffff',
        buttonHoverColor: '#555555'
      },
      light: {
        bgColor: '#ffffff',
        textColor: '#000000',
        buttonColor: '#000000',
        timerColor: '#000000',
        buttonHoverColor: '#666666'
      },
      navy: {
        bgColor: '#1a1a2e',
        textColor: '#ffffff',
        buttonColor: '#00d4ff',
        timerColor: '#00d4ff',
        buttonHoverColor: '#0099cc'
      },
      purple: {
        bgColor: '#0f3460',
        textColor: '#ffffff',
        buttonColor: '#e94560',
        timerColor: '#e94560',
        buttonHoverColor: '#c13651'
      }
    };
    
    const colors = presets[preset];
    if (colors) {
      // Atualizar inputs
      document.getElementById('bgColor').value = colors.bgColor;
      document.getElementById('textColor').value = colors.textColor;
      document.getElementById('buttonColor').value = colors.buttonColor;
      document.getElementById('timerColor').value = colors.timerColor;
      
      // Atualizar vari√°veis
      bgColor = colors.bgColor;
      textColor = colors.textColor;
      buttonColor = colors.buttonColor;
      timerColor = colors.timerColor;
      buttonHoverColor = colors.buttonHoverColor;
      
      // Aplicar cores
      applyColors();
      
      // Atualizar estado dos presets
      document.querySelectorAll('.preset-color').forEach(el => el.classList.remove('active'));
      event.target.classList.add('active');
    }
  }
  
  // Fun√ß√µes do modal
  function openModal() {
    document.getElementById('configModal').style.display = 'block';
  }
  
  function closeModal() {
    document.getElementById('configModal').style.display = 'none';
  }
  
  // Salvar configura√ß√µes
  function saveSettings() {
    // Obter valores dos inputs
    pomodoroTime = parseInt(document.getElementById('pomodoroTime').value);
    shortBreakTime = parseInt(document.getElementById('shortBreakTime').value);
    longBreakTime = parseInt(document.getElementById('longBreakTime').value);
    
    bgColor = document.getElementById('bgColor').value;
    textColor = document.getElementById('textColor').value;
    buttonColor = document.getElementById('buttonColor').value;
    timerColor = document.getElementById('timerColor').value;
    
    // Salvar no localStorage
    const settings = {
      pomodoroTime,
      shortBreakTime,
      longBreakTime,
      bgColor,
      textColor,
      buttonColor,
      timerColor,
      buttonHoverColor
    };
    
    safeLocalStorage('set', 'pomodoroSettings', JSON.stringify(settings));
    
    // Aplicar cores
    applyColors();
    
    // Atualizar bot√µes com novos tempos
    if (selectedOption === pomodoroTime) {
      setTime(pomodoroTime);
    } else if (selectedOption === shortBreakTime) {
      setTime(shortBreakTime);
    } else if (selectedOption === longBreakTime) {
      setTime(longBreakTime);
    }
    
    // Fechar modal
    closeModal();
    
    // Mostrar mensagem de sucesso
    showNotification('Configura√ß√µes guardadas com sucesso!');
  }
  
  // Reset configura√ß√µes
  function resetSettings() {
    // Detectar se est√° no ambiente Notion
    const isNotion = isNotionEnvironment();
    
    // Fun√ß√£o para executar o reset
    function executeReset() {
      // Usar safeLocalStorage para remover configura√ß√µes
      safeLocalStorage('remove', 'pomodoroSettings');
      
      // Reset para valores padr√£o
      pomodoroTime = 25;
      shortBreakTime = 5;
      longBreakTime = 10;
      bgColor = '#191919'; // Notion dark mode RGB(25,25,25)
      textColor = '#ffffff';
      buttonColor = '#ffffff';
      timerColor = '#ffffff';
      buttonHoverColor = '#555555';
      
      // Atualizar inputs
      document.getElementById('pomodoroTime').value = pomodoroTime;
      document.getElementById('shortBreakTime').value = shortBreakTime;
      document.getElementById('longBreakTime').value = longBreakTime;
      document.getElementById('bgColor').value = bgColor;
      document.getElementById('textColor').value = textColor;
      document.getElementById('buttonColor').value = buttonColor;
      document.getElementById('timerColor').value = timerColor;
      
      // Aplicar cores
      applyColors();
      
      // Reset presets
      document.querySelectorAll('.preset-color').forEach(el => el.classList.remove('active'));
      document.querySelector('.preset-color').classList.add('active');
      
      // Atualizar temporizador atual se estiver em modo padr√£o
      if (selectedOption === pomodoroTime || selectedOption === shortBreakTime || selectedOption === longBreakTime) {
        if (selectedOption === pomodoroTime) {
          setTime(pomodoroTime);
        } else if (selectedOption === shortBreakTime) {
          setTime(shortBreakTime);
        } else if (selectedOption === longBreakTime) {
          setTime(longBreakTime);
        }
      }
      
      // Notifica√ß√£o adaptada ao ambiente
      if (isNotion) {
        // No Notion, usar um m√©todo mais simples de notifica√ß√£o
        const statusEl = document.querySelector('.status') || document.createElement('div');
        if (!document.querySelector('.status')) {
          statusEl.className = 'status';
          statusEl.style.cssText = 'position: absolute; top: 10px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.8); color: white; padding: 5px 10px; border-radius: 5px; font-size: 12px; z-index: 1000;';
          document.body.appendChild(statusEl);
        }
        statusEl.textContent = 'Configura√ß√µes resetadas!';
        statusEl.style.display = 'block';
        setTimeout(() => {
          statusEl.style.display = 'none';
        }, 2000);
      } else {
        showNotification('Configura√ß√µes resetadas para os valores padr√£o!');
      }
    }
    
    // No Notion, executar diretamente sem confirma√ß√£o
    if (isNotion) {
      executeReset();
    } else {
      // Fora do Notion, usar confirma√ß√£o normal
      if (confirm('Tem certeza que deseja resetar as configura√ß√µes para os valores padr√£o?')) {
        executeReset();
      }
    }
  }
  
  // Notifica√ß√£o simples
  function showNotification(message) {
    const notification = document.createElement('div');
    notification.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #007AFF 0%, #0051D5 100%);
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      font-size: 0.9rem;
      z-index: 10000;
      box-shadow: 0 4px 12px rgba(0, 122, 255, 0.3);
      animation: slideIn 0.3s ease;
    `;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOut 0.3s ease';
      setTimeout(() => {
        document.body.removeChild(notification);
      }, 300);
    }, 3000);
  }
  
  // Fechar modal ao clicar fora
  window.onclick = function(event) {
    const modal = document.getElementById('configModal');
    if (event.target === modal) {
      closeModal();
    }
  }
  
  // Adicionar anima√ß√µes CSS
  const style = document.createElement('style');
  style.textContent = `
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }
  `;
  document.head.appendChild(style);
  
  // Carregar configura√ß√µes ao iniciar
  loadSettings();
  
  // Aplicar cores imediatamente (garante que a cor padr√£o seja aplicada)
  applyColors();
  
  // Fun√ß√µes existentes do temporizador
  function setTime(minutes) {
    timeLeft = minutes * 60;
    selectedOption = minutes;
    updateDisplay();
  }

  function startPauseTimer() {
    running = !running;
    if (running) {
      timerInterval = setInterval(updateTimer, 1000);
      document.getElementById("startPauseBtn").innerHTML = '<i class="fas fa-pause"></i>';
      document.getElementById("resetBtn").disabled = true;
    } else {
      clearInterval(timerInterval);
      document.getElementById("startPauseBtn").innerHTML = '<i class="fas fa-play"></i>';
      document.getElementById("resetBtn").disabled = false;
    }
  }

  function resetTimer() {
    if (!running) {
      timeLeft = selectedOption * 60;
      updateDisplay();
      document.getElementById("startPauseBtn").innerHTML = '<i class="fas fa-play"></i>';
    }
  }

  function updateTimer() {
    if (timeLeft > 0) {
      timeLeft--;
      updateDisplay();
    } else {
      clearInterval(timerInterval);
      document.getElementById("startPauseBtn").innerHTML = '<i class="fas fa-play"></i>';
      playSound();
      document.getElementById("resetBtn").disabled = false;
    }
  }

  function updateDisplay() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    const displayTime = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
    document.getElementById("timer").textContent = displayTime;
  }

  function playSound() {
    var audio = document.getElementById("beepSound");
    audio.play();
  }
  
  // Inicializar display
  updateDisplay();
  document.getElementById("resetBtn").disabled = false;
</script>
</body>
</html>